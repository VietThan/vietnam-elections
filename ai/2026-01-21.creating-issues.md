# Issue Scratchpad âœï¸

## Team Focus (near-term) ğŸš€

### Data pipeline
- [ ] Build NA15-2021 data provenance audit report (missing sources, stale timestamps, ambiguous fields).
- [ ] Add a QA gate that validates all candidate fields have at least one source URL.
- [ ] Add a checksum/metadata file for `public/data/` exports (build timestamp, commit hash, counts).

### Site UX
- [ ] Add a data coverage banner on cycle pages (what is included/excluded, last updated timestamp).
- [ ] Add per-constituency summary cards for NA15-2021 results.
- [ ] Add a source citation pattern for every table/section in UI (consistent placement and style).

## Contributor-Friendly (good first issues) ğŸ¤

### Data gathering (two issues per election cycle) ğŸ§­

Status note: GitHub issues have been created for all cycles except NA15-2021, with two issues per cycle (raw sources + ingest/export).

Issue index:
| Cycle | Raw sources | Ingest + export |
| --- | --- | --- |
| NA01-1946 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/1 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/2 |
| NA02-1960 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/3 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/4 |
| NA03-1964 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/5 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/6 |
| NA04-1971 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/7 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/8 |
| NA05-1975 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/9 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/10 |
| NA06-1976 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/11 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/12 |
| NA07-1981 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/13 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/14 |
| NA08-1987 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/15 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/16 |
| NA09-1992 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/17 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/18 |
| NA10-1997 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/19 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/20 |
| NA11-2002 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/21 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/22 |
| NA12-2007 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/23 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/24 |
| NA13-2011 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/25 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/26 |
| NA14-2016 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/27 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/28 |
| NA16-2026 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/29 | https://github.com/bamboo-filing-cabinet/vietnam-elections/issues/30 |

Raw sources (official docs + provenance):
- [x] NA01-1946: gather official sources (units, candidates, results).
- [x] NA02-1960: gather official sources (units, candidates, results).
- [x] NA03-1964: gather official sources (units, candidates, results).
- [x] NA04-1971: gather official sources (units, candidates, results).
- [x] NA05-1975: gather official sources (units, candidates, results).
- [x] NA06-1976: gather official sources (units, candidates, results).
- [x] NA07-1981: gather official sources (units, candidates, results).
- [x] NA08-1987: gather official sources (units, candidates, results).
- [x] NA09-1992: gather official sources (units, candidates, results).
- [x] NA10-1997: gather official sources (units, candidates, results).
- [x] NA11-2002: gather official sources (units, candidates, results).
- [x] NA12-2007: gather official sources (units, candidates, results).
- [x] NA13-2011: gather official sources (units, candidates, results).
- [x] NA14-2016: gather official sources (units, candidates, results).
- [ ] NA15-2021: covered in current dataset (no new issue needed).
- [x] NA16-2026: gather official sources (units, candidates, results).

Ingest + export (staging.db -> public/data):
- [x] NA01-1946: ingest sources into `staging.db` and export JSON.
- [x] NA02-1960: ingest sources into `staging.db` and export JSON.
- [x] NA03-1964: ingest sources into `staging.db` and export JSON.
- [x] NA04-1971: ingest sources into `staging.db` and export JSON.
- [x] NA05-1975: ingest sources into `staging.db` and export JSON.
- [x] NA06-1976: ingest sources into `staging.db` and export JSON.
- [x] NA07-1981: ingest sources into `staging.db` and export JSON.
- [x] NA08-1987: ingest sources into `staging.db` and export JSON.
- [x] NA09-1992: ingest sources into `staging.db` and export JSON.
- [x] NA10-1997: ingest sources into `staging.db` and export JSON.
- [x] NA11-2002: ingest sources into `staging.db` and export JSON.
- [x] NA12-2007: ingest sources into `staging.db` and export JSON.
- [x] NA13-2011: ingest sources into `staging.db` and export JSON.
- [x] NA14-2016: ingest sources into `staging.db` and export JSON.
- [ ] NA15-2021: already ingested and exported (no new issue needed).
- [x] NA16-2026: ingest sources into `staging.db` and export JSON.

Dependency note: each ingest/export issue has `Blocked by #<raw-issue>` in the body so GitHub shows the relationship.
CLI note: relationships were applied via GitHub issue dependencies API, e.g. `gh api repos/bamboo-filing-cabinet/vietnam-elections/issues/<blocked>/dependencies/blocked_by -F issue_id=<blocking-issue-id>`. Verify with `gh api repos/bamboo-filing-cabinet/vietnam-elections/issues/<blocked>/dependencies/blocked_by --jq '.[].number'`.

Full script used to set relationships (raw -> ingest/export):
```bash
REPO="bamboo-filing-cabinet/vietnam-elections"
PAIRS=(1:2 3:4 5:6 7:8 9:10 11:12 13:14 15:16 17:18 19:20 21:22 23:24 25:26 27:28 29:30)

for pair in "${PAIRS[@]}"; do
  A="${pair%%:*}"
  B="${pair##*:}"

  A_ID="$(gh api "repos/$REPO/issues/$A" --jq .id)"
  blocked_by="$(gh api "repos/$REPO/issues/$B/dependencies/blocked_by" --jq '.[].number' || true)"

  if printf "%s\n" "$blocked_by" | grep -qx "$A"; then
    echo "OK: #$B already blocked by #$A"
  else
    gh api \
      -X POST \
      -H "Accept: application/vnd.github+json" \
      -H "X-GitHub-Api-Version: 2022-11-28" \
      "repos/$REPO/issues/$B/dependencies/blocked_by" \
      -F "issue_id=$A_ID" >/dev/null
    echo "SET: #$B blocked by #$A"
  fi
done
```

gh api verification example (issue 1 blocking issue 2):
```bash
REPO="bamboo-filing-cabinet/vietnam-elections"
gh api \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  "repos/$REPO/issues/2/dependencies/blocked_by" \
  --jq '.[].number' \
  | grep -x "1"
```

## Backlog / Ideas ğŸ’¡
- [ ] Add an index of source documents per cycle (PDFs, bulletins) with a download audit trail.
- [ ] Add data dictionary docs for all exported JSON fields.
- [ ] Add a contributor guide specifically for data sourcing and citations.

---

## Labels to use ğŸ·ï¸
- `data-raw` (raw sources)
- `data-pipeline` (ingest + export)
- `cycle:NAxx-YYYY` (cycle scope)
- `good first issue` (optional for raw sourcing)
- `needs-sources` (blocked on provenance)

Label status: labels created in GitHub for all cycles (NA01â€“NA16) plus `data-raw`, `data-pipeline`, and `needs-sources`.

---

## Issue template notes ğŸ§©
When filing an issue, include:
- Scope (cycle + dataset)
- Required sources (official URLs)
- Output target (CSV/JSON + path)
- Acceptance criteria (fields + QA checks)
- Suggested tooling (if any)

---

## Issue templates (draft) ğŸ“

### Raw sources issue ğŸ“š
Title: ğŸ“š NAxx-YYYY raw sources: collect official units/candidates/results with provenance

Summary âœ¨
Gather official source documents for NAxx-YYYY (units, candidates, results) with URLs + retrieval dates, stored under `data/naXX-YYYY/`.

Requirements âœ…
- Official sources only (government/official bulletins)
- Every document has URL + retrieval date
- Store raw files under `data/naXX-YYYY/` with clear filenames

Deliverables ğŸ“¦
- Source list (URLs + retrieval dates) saved in repo
- Raw files checked in under `data/naXX-YYYY/`
- Short note describing coverage and gaps (if any)

Acceptance Criteria ğŸ¯
- Each dataset (units/candidates/results) has at least one official source
- All sources include retrieval date
- Files are organized and reproducible

### Ingest + export issue ğŸ§ª
Title: ğŸ§ª NAxx-YYYY ingest + export: staging.db and JSON outputs

Summary âœ¨
Ingest NAxx-YYYY raw sources into `staging.db` and export JSON to `public/data/elections/naXX-YYYY/`.

Requirements âœ…
- Use scripts in `data/naXX-YYYY/` or add new ones as needed
- All exported fields are source-linked
- QA checks pass (no missing sources or retrieval dates)

Deliverables ğŸ“¦
- Updated ingestion scripts
- Populated `staging.db` entries for NAxx-YYYY
- Exported JSON under `public/data/elections/naXX-YYYY/`

Acceptance Criteria ğŸ¯
- Running the build/export pipeline reproduces outputs
- Exports include source URLs + retrieval dates
- No manual steps beyond documented scripts
